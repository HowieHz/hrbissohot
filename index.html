<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">å“ˆå°”æ»¨å¤ªâ„¢çƒ­äº†</title>
    <script defer src="https://umami.howiehz.top/script.js" data-website-id="ecf51c4e-d7d8-4f6d-a4cd-89ce7112ab02" data-domains="hrbissohot.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
            background-color: #fff;
        }
        
        h1 {
            text-align: center;
            color: #d73a49;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            font-size: 1.1em;
            margin-bottom: 30px;
        }
        
        .intro {
            background-color: #f6f8fa;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 30px;
            border-left: 4px solid #0366d6;
        }
        
        .ac-summary {
            background-color: #f8f9fa;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .ac-summary h3 {
            margin: 0 0 15px 0;
            color: #0366d6;
            font-size: 1.2em;
        }
        
        .ac-list {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .ac-category {
            flex: 1;
            min-width: 200px;
        }
        
        .ac-category h4 {
            margin: 0 0 8px 0;
            font-size: 1em;
            color: #333;
        }
        
        .ac-category.full h4 {
            color: #28a745;
        }
        
        .ac-category.basic h4 {
            color: #17a2b8;
        }
        
        .ac-category.classroom h4 {
            color: #fd7e14;
        }
        
        .ac-category.dormitory h4 {
            color: #0066cc;
        }
        
        .ac-category.canteen h4 {
            color: #e83e8c;
        }
        
        .ac-category.library h4 {
            color: #6f42c1;
        }
        
        .ac-category.none h4 {
            color: #dc3545;
        }
        
        .ac-category.pending h4 {
            color: #6c757d;
        }
        
        .ac-schools {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .ac-schools li {
            padding: 4px 0;
            font-size: 0.9em;
            color: #666;
            border-bottom: 1px solid #eee;
        }
        
        .ac-schools li:last-child {
            border-bottom: none;
        }
        
        .contribute {
            margin-bottom: 30px;
        }
        
        .contribute-section {
            background-color: #f8f9fa;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .contribute-section h3 {
            margin: 0 0 20px 0;
            color: #28a745;
            font-size: 1.2em;
            text-align: center;
        }
        
        .contribute-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .contribute-option {
            background-color: white;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 20px;
            text-align: center;
            transition: box-shadow 0.2s;
        }
        
        .contribute-option:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .contribute-option .icon {
            font-size: 2em;
            margin-bottom: 10px;
            display: block;
        }
        
        .contribute-option h4 {
            margin: 0 0 10px 0;
            color: #333;
            font-size: 1.1em;
        }
        
        .contribute-option p {
            margin: 0 0 15px 0;
            color: #666;
            font-size: 0.9em;
            line-height: 1.4;
        }
        
        .contribute-option .update-delay {
            font-size: 0.8em;
            color: #888;
            margin-bottom: 15px;
            font-style: italic;
        }
        
        .contribute-btn {
            display: inline-block;
            background-color: #28a745;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.2s;
        }
        
        .contribute-btn:hover {
            background-color: #218838;
            color: white;
        }
        
        .contribute-btn.secondary {
            background-color: #17a2b8;
        }
        
        .contribute-btn.secondary:hover {
            background-color: #138496;
        }
        
        /* ç§»åŠ¨è®¾å¤‡é€‚é… */
        @media (max-width: 768px) {
            .contribute-options {
                grid-template-columns: 1fr;
            }
            
            .ac-list {
                flex-direction: column;
            }
            
            .ac-category {
                min-width: unset;
            }
        }
        
        .category-title {
            font-size: 1.5em;
            color: #0366d6;
            margin: 30px 0 15px 0;
            border-bottom: 2px solid #e1e4e8;
            padding-bottom: 10px;
        }
        
        .school {
            background-color: #f8f9fa;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            margin-bottom: 15px;
            padding: 15px;
        }
        
        .school h3 {
            margin: 0 0 10px 0;
            color: #0366d6;
        }
        
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .status-supported {
            background-color: #28a745;
            color: white;
        }
        
        .status-partial {
            background-color: #ffc107;
            color: #212529;
        }
        
        .status-unsupported {
            background-color: #dc3545;
            color: white;
        }

        .status-pending {
            background-color: #e1e4e8;
            color: #6c757d;
        }
        
        .school-info {
            font-size: 0.9em;
            color: #666;
        }
        
        .school-info p {
            margin: 5px 0;
        }
        
        .footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid #e1e4e8;
            color: #666;
            font-size: 0.9em;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            color: #666;
        }
        
        .error {
            background-color: #f8d7da;
            color: #721c24;
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div id="loading" class="loading">æ­£åœ¨åŠ è½½æ•°æ®...</div>
    <div id="error" class="error" style="display: none;"></div>
    <div id="content" style="display: none;">
        <h1 id="main-title"></h1>
        <div id="subtitle" class="subtitle"></div>
        
        <div id="intro" class="intro"></div>
        
        <div id="ac-summary" class="ac-summary"></div>
        
        <div id="contribute" class="contribute-section"></div>
        
        <div id="schools-container"></div>
        
        <div id="footer" class="footer"></div>
    </div>

    <script>
        // ä» JSON æ–‡ä»¶åŠ è½½æ•°æ®
        async function loadData() {
            try {
                const response = await fetch('data.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                return data;
            } catch (error) {
                console.error('Error loading data:', error);
                throw error;
            }
        }

        // æ¸²æŸ“é¡µé¢å†…å®¹
        function renderPage(data) {
            // è®¾ç½®é¡µé¢æ ‡é¢˜
            document.getElementById('page-title').textContent = data.title.replace('ğŸŒ¡ï¸ ', '');
            document.getElementById('main-title').textContent = data.title;
            document.getElementById('subtitle').textContent = data.subtitle;

            // è®¾ç½®ä»‹ç»éƒ¨åˆ†
            const introElement = document.getElementById('intro');
            const homepageLink = data.project_info && data.project_info.repository 
                ? `<p style="text-align: center; margin-top: 15px;"><a href="${data.project_info.repository}" target="_blank" style="color: #0366d6; text-decoration: none; font-weight: bold;">ğŸ  é¡¹ç›®é¦–é¡µ</a></p>`
                : '';
            
            introElement.innerHTML = `
                <p><strong>${data.intro.description}</strong></p>
                <p>${data.intro.details}</p>
                ${homepageLink}
            `;

            // ç§»é™¤é¡¹ç›®ä¿¡æ¯éƒ¨åˆ†ï¼ˆå·²ç®€åŒ–åˆ°ä»‹ç»ä¸­ï¼‰

            // ç”Ÿæˆç©ºè°ƒè¦†ç›–æƒ…å†µæ±‡æ€»
            const acSummaryElement = document.getElementById('ac-summary');
            const acCoverage = {
                full: [],      // å®Œå…¨è¦†ç›–ï¼ˆ4ä¸ªåœºæ‰€éƒ½æœ‰ï¼‰
                basic: [],     // åŸºæœ¬è¦†ç›–ï¼ˆ2-3ä¸ªåœºæ‰€ï¼‰
                classroom: [], // æ•™å®¤è¦†ç›–
                dormitory: [], // å®¿èˆè¦†ç›–
                canteen: [],   // é£Ÿå ‚è¦†ç›–
                library: [],   // å›¾ä¹¦é¦†è¦†ç›–
                none: [],
                pending: []
            };

            // æ”¶é›†æ‰€æœ‰å­¦æ ¡çš„ç©ºè°ƒè¦†ç›–æƒ…å†µ
            data.categories.forEach(category => {
                category.schools.forEach(school => {
                    // å¦‚æœæ˜¯ä¿¡æ¯å¾…è¡¥å……çš„å­¦æ ¡ï¼Œå•ç‹¬åˆ†ç±»
                    if (school.status === 'pending') {
                        acCoverage.pending.push(school.name);
                        return;
                    }
                    
                    if (school.airConditioningCoverage && Array.isArray(school.airConditioningCoverage)) {
                        const coverageTypes = school.airConditioningCoverage;
                        
                        // å¦‚æœæ²¡æœ‰ä»»ä½•è¦†ç›–ï¼Œåˆ™å½’ç±»ä¸ºå®Œå…¨æ²¡æœ‰è¦†ç›–
                        if (coverageTypes.length === 0) {
                            acCoverage.none.push(school.name);
                            return;
                        }
                        
                        // ç»Ÿè®¡å…·ä½“åœºæ‰€è¦†ç›–æƒ…å†µ
                        let coverageCount = 0;
                        coverageTypes.forEach(coverage => {
                            switch (coverage) {
                                case 'classroom':
                                    acCoverage.classroom.push(school.name);
                                    coverageCount++;
                                    break;
                                case 'dormitory':
                                    acCoverage.dormitory.push(school.name);
                                    coverageCount++;
                                    break;
                                case 'canteen':
                                    acCoverage.canteen.push(school.name);
                                    coverageCount++;
                                    break;
                                case 'library':
                                    acCoverage.library.push(school.name);
                                    coverageCount++;
                                    break;
                            }
                        });
                        
                        // æ ¹æ®è¦†ç›–åœºæ‰€æ•°é‡è‡ªåŠ¨åˆ¤æ–­ç­‰çº§
                        if (coverageCount >= 4) {
                            acCoverage.full.push(school.name);
                        } else if (coverageCount >= 2) {
                            acCoverage.basic.push(school.name);
                        }
                    }
                });
            });

            // æ¸²æŸ“ç©ºè°ƒè¦†ç›–æƒ…å†µæ±‡æ€»
            acSummaryElement.innerHTML = `
                <h3>ğŸŒ¡ï¸ ç©ºè°ƒè¦†ç›–æƒ…å†µæ¦‚è§ˆ</h3>
                <div class="ac-list">
                    <div class="ac-category full">
                        <h4>âœ… å®Œå…¨è¦†ç›– (${acCoverage.full.length}æ‰€)</h4>
                        <ul class="ac-schools">
                            ${acCoverage.full.map(school => `<li>${school}</li>`).join('')}
                            ${acCoverage.full.length === 0 ? '<li>æš‚æ— æ•°æ®</li>' : ''}
                        </ul>
                        <small style="color: #666; font-size: 0.8em;">æ•™å®¤ã€å®¿èˆã€é£Ÿå ‚ã€å›¾ä¹¦é¦†å››ä¸ªåœºæ‰€éƒ½æœ‰ç©ºè°ƒ</small>
                    </div>
                    <div class="ac-category basic">
                        <h4>ğŸ†— åŸºæœ¬è¦†ç›– (${acCoverage.basic.length}æ‰€)</h4>
                        <ul class="ac-schools">
                            ${acCoverage.basic.map(school => `<li>${school}</li>`).join('')}
                            ${acCoverage.basic.length === 0 ? '<li>æš‚æ— æ•°æ®</li>' : ''}
                        </ul>
                        <small style="color: #666; font-size: 0.8em;">è‡³å°‘ä¸¤ä¸ªä¸»è¦åœºæ‰€æœ‰ç©ºè°ƒè¦†ç›–</small>
                    </div>
                    <div class="ac-category classroom">
                        <h4>ğŸ« æ•™å®¤æœ‰è¦†ç›– (${acCoverage.classroom.length}æ‰€)</h4>
                        <ul class="ac-schools">
                            ${acCoverage.classroom.map(school => `<li>${school}</li>`).join('')}
                            ${acCoverage.classroom.length === 0 ? '<li>æš‚æ— æ•°æ®</li>' : ''}
                        </ul>
                    </div>
                    <div class="ac-category dormitory">
                        <h4>ğŸ  å®¿èˆæœ‰è¦†ç›– (${acCoverage.dormitory.length}æ‰€)</h4>
                        <ul class="ac-schools">
                            ${acCoverage.dormitory.map(school => `<li>${school}</li>`).join('')}
                            ${acCoverage.dormitory.length === 0 ? '<li>æš‚æ— æ•°æ®</li>' : ''}
                        </ul>
                    </div>
                    <div class="ac-category canteen">
                        <h4>ğŸ½ï¸ é£Ÿå ‚æœ‰è¦†ç›– (${acCoverage.canteen.length}æ‰€)</h4>
                        <ul class="ac-schools">
                            ${acCoverage.canteen.map(school => `<li>${school}</li>`).join('')}
                            ${acCoverage.canteen.length === 0 ? '<li>æš‚æ— æ•°æ®</li>' : ''}
                        </ul>
                    </div>
                    <div class="ac-category library">
                        <h4>ğŸ“š å›¾ä¹¦é¦†/è‡ªä¹ å®¤æœ‰è¦†ç›– (${acCoverage.library.length}æ‰€)</h4>
                        <ul class="ac-schools">
                            ${acCoverage.library.map(school => `<li>${school}</li>`).join('')}
                            ${acCoverage.library.length === 0 ? '<li>æš‚æ— æ•°æ®</li>' : ''}
                        </ul>
                    </div>
                    <div class="ac-category none">
                        <h4>âŒ å®Œå…¨æ²¡æœ‰è¦†ç›– (${acCoverage.none.length}æ‰€)</h4>
                        <ul class="ac-schools">
                            ${acCoverage.none.map(school => `<li>${school}</li>`).join('')}
                            ${acCoverage.none.length === 0 ? '<li>æš‚æ— æ•°æ®</li>' : ''}
                        </ul>
                    </div>
                    <div class="ac-category pending">
                        <h4>â“ ä¿¡æ¯å¾…è¡¥å…… (${acCoverage.pending.length}æ‰€)</h4>
                        <ul class="ac-schools">
                            ${acCoverage.pending.map(school => `<li>${school}</li>`).join('')}
                            ${acCoverage.pending.length === 0 ? '<li>æš‚æ— æ•°æ®</li>' : ''}
                        </ul>
                    </div>
                </div>
            `;

            // è®¾ç½®è´¡çŒ®éƒ¨åˆ†
            const contributeElement = document.getElementById('contribute');
            if (data.contribute_links && data.contribute_links.length > 0) {
                const contributeOptionsHtml = data.contribute_links.map(link => `
                    <div class="contribute-option">
                        <span class="icon">${link.icon}</span>
                        <h4>${link.title}</h4>
                        <p>${link.description}</p>
                        <div class="update-delay">â±ï¸ ${link.update_delay}</div>
                        <a href="${link.url}" class="contribute-btn ${link.type === 'github_issue' ? '' : 'secondary'}" target="_blank">
                            ${link.type === 'github_issue' ? 'æäº¤ Issue' : 'å¡«å†™é—®å·'}
                        </a>
                    </div>
                `).join('');
                
                contributeElement.innerHTML = `
                    <h3>ğŸ¤ è´¡çŒ®ä¿¡æ¯</h3>
                    <div class="contribute-options">
                        ${contributeOptionsHtml}
                    </div>
                `;
            }

            // æ¸²æŸ“å­¦æ ¡ä¿¡æ¯
            const schoolsContainer = document.getElementById('schools-container');
            let schoolsHtml = '';

            data.categories.forEach(category => {
                schoolsHtml += `<h2 class="category-title">${category.name}</h2>`;
                
                category.schools.forEach(school => {
                    const statusClass = `status-${school.status}`;
                    
                    schoolsHtml += `
                        <div class="school">
                            <h3>${school.name}</h3>
                            <div class="status ${statusClass}">çŠ¶æ€ï¼š${school.statusText}</div>
                            <div class="school-info">
                                <p>${school.description}</p>
                                ${school.details.map(detail => `<p>${detail}</p>`).join('')}
                            </div>
                        </div>
                    `;
                });
            });

            schoolsContainer.innerHTML = schoolsHtml;

            // è®¾ç½®é¡µè„š
            const footerElement = document.getElementById('footer');
            footerElement.innerHTML = `
                <p>${data.footer.copyright}</p>
                <p>æœ€åæ›´æ–°æ—¶é—´ï¼š${data.footer.lastUpdate}</p>
                <p>${data.footer.tip}</p>
                <p>${data.footer.totalCount}</p>
            `;
        }

        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        function showError(message) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('error').style.display = 'block';
            document.getElementById('error').textContent = `åŠ è½½å¤±è´¥: ${message}`;
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const data = await loadData();
                renderPage(data);
                
                // éšè—åŠ è½½æç¤ºï¼Œæ˜¾ç¤ºå†…å®¹
                document.getElementById('loading').style.display = 'none';
                document.getElementById('content').style.display = 'block';
            } catch (error) {
                showError(error.message);
            }
        });
    </script>
</body>
</html>
